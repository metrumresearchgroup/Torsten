ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = "ESS_tail/(sampling time * number of chains)") +
    scale_fill_discrete(name="Number of \nparallel chains")
ggsave(filename="ess_tail_per_time_chain.pdf",width=6, height=4)
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_bulk_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = "ESS_bulk/(sampling time * number of chains)") +
    scale_fill_discrete(name="Number of \nparallel chains")
ggsave(filename="ess_bulk_per_time_chain.pdf",width=6, height=4)
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(sampling_time  number of chains)")) +
    scale_fill_discrete(name="Number of \nparallel chains")
library(latex2exp)
install.packages(latex2exp)
install.packages("latex2exp")
library("latex2exp")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(sampling_time  number of chains)")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} \times n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} \\times n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} \\\times n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} (\\times) n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} {\\times} n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} X n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_tail/(Time_{sampling} x n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")

ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})")) +
    scale_fill_discrete(name="Number of \nparallel chains")

ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_tail_per_sec_per_chain)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})")) +
    scale_fill_discrete(name=TeX("n_{chains}"))
source("plot.R")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_bulk_per_sec)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_sec"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_{bulk}/(Time_{sampling})")) +
    scale_fill_discrete(name=TeX("n_{chains}"))
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(fill=as.factor(parallel_chains), x=as.factor(target_ESS), y=ess_bulk_per_sec)) +
    geom_bar(position="dodge", stat="identity") +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_sec"]][1],linetype = "dashed") +
    labs(x = "Target ESS", y = TeX("ESS_{bulk}/Time_{sampling}")) +
    scale_fill_discrete(name=TeX("n_{chains}"))
ggsave(filename="ess_bulk_per_time.pdf",width=6, height=4)
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_tail_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})")) +
    scale_fill_discrete(name="Target ESS")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_tail_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})")) +
    scale_fill_discrete(name="Target ESS")+scale_y_continuous(trans='log2')
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_tail_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})")) +
    scale_fill_discrete(name="Target ESS")+scale_x_continuous(trans='log2')
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_tail_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})")) +
    scale_group_discrete(name="Target ESS")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_tail_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})"), linetype="fdaf") 
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_tail_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_tail_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{tail}/(Time_{sampling} x n_{chains})"), shape="fdaf",linetype="fdaf")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_bulk_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{bulk}/(Time_{sampling} x n_{chains})"), shape="fdaf",linetype="fdaf")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_bulk_per_sec_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_sec_per_chain"]][1],linetype = "dashed") +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{bulk}/(Time_{sampling} x n_{chains})"), shape="Target ESS",linetype="Target ESS")
source("plot.R")
ggplot(lp.summary %>% filter(method=="cross-chain"),
       aes(group=as.factor(target_ESS), x=parallel_chains, y=ess_bulk_per_sec)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_sec"]][1],linetype = "dashed") +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chains}"), y = TeX("ESS_{bulk}/Time_{sampling}"), shape="Target ESS",linetype="Target ESS")
source("plot.R")
source("plot.R")
source("plot.R")
ls()
write.table(extended.summary, file = "summary.csv")
write.table(extended.summary, file = "summary.csv", sep=",")
lp.summary
lp.summary  <- lp.summary %>% mutate(total_time=warmup_time+sampling_time)
lp.summary
lp.summary  <- lp.summary %>% mutate(ess_bulk_per_total_time_per_chain=ess_bulk/parallel_chains/total_time)
lp.summary
lp.summary  <- lp.summary %>% mutate(ess_tail_per_total_time_per_chain=ess_tail/parallel_chains/total_time)
lp.summary
ggplot(lp.summary %>% filter(method=="cross-chain"),
        aes(group=as.factor(target_ESS), color=as.factor(target_ESS), x=parallel_chains, y=ess_bulk_per_total_time_per_chain)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    geom_hline(yintercept=lp.summary[["ess_bulk_per_total_time_per_chain"]][1],linetype = "dashed") +
    scale_x_continuous(trans='log2') +
    labs(x = TeX("n_{chain}"), y = TeX("ESS_{bulk}/(Time_{total} x n_{chain})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
source("plot.R")
lp.summary  <- lp.summary %>% mutate(ess_tail_per_total_time=ess_tail/total_time)
lp.summary  <- lp.summary %>% mutate(ess_bulk_per_total_time=ess_bulk/total_time)
lp.summary
lp.summary %>% select(target_ESS=200)
lp.summary %>% select(target_ESS="200")
lp.summary %>% filter(target_ESS==200)
lp.summary %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/0.0710)
lp.summary
lp.summary %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/0.0710)
lp.summary %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/ess_bulk_per_total_time[1])
lp.efficiency.200 <- lp.summary %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/ess_bulk_per_total_time[1])
lp.efficiency.400 <- lp.summary %>% filter(target_ESS==400) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/ess_bulk_per_total_time[1])
lp.efficiency.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/ess_bulk_per_total_time[1])
lp.efficiency.200
lp.efficiency.400
lp.efficiency.600
lp.bulk.efficiency  <- bind_rows(lp.efficiency.200, lp.efficiency.400, lp.efficiency.600)
lp.bulk.efficiency
lp.efficiency.200 <- lp.summary %>% filter(target_ESS==200) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/ess_tail_per_total_time[1])
lp.efficiency.400 <- lp.summary %>% filter(target_ESS==400) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/ess_tail_per_total_time[1])
lp.efficiency.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/ess_tail_per_total_time[1])
lp.tail.efficiency  <- bind_rows(lp.efficiency.200, lp.efficiency.400, lp.efficiency.600)
lp.tail.efficiency
lp.efficiency <- lp.bulk.efficiency %>% add_column(lp.bulk.efficiency[[ess_tail_efficiency]])
lp.efficiency <- lp.bulk.efficiency %>% add_column(lp.tail.efficiency[[ess_tail_efficiency]])
lp.bulk.efficiency %>% add_column(lp.tail.efficiency$ess_tail_efficiency)
lp.bulk.efficiency %>% add_column(ess_tail_efficiency=lp.tail.efficiency$ess_tail_efficiency)
lp.parallel.efficiency  <- lp.bulk.efficiency %>% add_column(ess_tail_efficiency=lp.tail.efficiency$ess_tail_efficiency)
lp.parallel.efficiency
ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
  color=as.factor(target_ESS), x=parallel_chains,
  y=ess_bulk_efficiency)) +
  geom_line(aes(linetype=as.factor(target_ES))) + geom_point(aes(shape=as.factor(target_ESS)))
ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
  color=as.factor(target_ESS), x=parallel_chains,
  y=ess_bulk_efficiency)) +
  geom_line(aes(linetype=as.factor(target_ESS))) + geom_point(aes(shape=as.factor(target_ESS)))
ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
  color=as.factor(target_ESS), x=parallel_chains,
  y=ess_bulk_efficiency)) +
  geom_line(aes(linetype=as.factor(target_ESS))) +
  geom_point(aes(shape=as.factor(target_ESS))) +
  scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2')
ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
  color=as.factor(target_ESS), x=parallel_chains,
  y=ess_bulk_efficiency)) +
  geom_line(aes(linetype=as.factor(target_ESS))) +
  geom_point(aes(shape=as.factor(target_ESS))) +
  scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
  labs(x = TeX("n_{chain}"), y = TeX("Speedup of ESS_{bulk}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggsave(filename="ess_bulk_per_total_time_speedup.pdf",width=6, height=4)
ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_bulk_efficiency)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{bulk}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggsave(filename="ess_bulk_per_total_time_speedup.pdf",width=6, height=4)
ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_tail_efficiency)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{tail}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggsave(filename="ess_tail_per_total_time_speedup.pdf",width=6, height=4)
lp.parallel.efficiency
lp.summary
lp.summary %>% filter(target_ESS==600) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.summary %>% filter(target_ESS==600)
lp.summary
lp.tail.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.tail.speedup.400 <- lp.summary %>% filter(target_ESS==400) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.tail.speedup.200 <- lp.summary %>% filter(target_ESS==200) %>% mutate(ess_tail_efficiency=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.bulk.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]))
lp.bulk.speedup.400 <- lp.summary %>% filter(target_ESS==400) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]))
lp.bulk.speedup.200 <- lp.summary %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]))
lp.tail.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.tail.speedup.400 <- lp.summary %>% filter(target_ESS==400) %>% mutate(ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.tail.speedup.200 <- lp.summary %>% filter(target_ESS==200) %>% mutate(ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.bulk.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]))
lp.bulk.speedup.400 <- lp.summary %>% filter(target_ESS==400) %>% mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]))
lp.bulk.speedup.200 <- lp.summary %>% filter(target_ESS==200) %>% mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]))
lp.speedup <- bind_rows(lp.bulk.speedup.200, lp.bulk.speedup.400, lp.bulk.speedup.600) %>% add_column(bind_rows(lp.tail.speedup.200, lp.tail.speedup.400,
                        lp.tail.speedup.600) [[ess_tail_speedup]])
bind_rows(lp.bulk.speedup.200, lp.bulk.speedup.400, lp.bulk.speedup.600)
ls()
rm(lp.bulk.speedup.200,lp.bulk.speedup.400, lp.bulk.speedup.600)
ls()
rm(lp.tail.speedup.200,lp.tail.speedup.400, lp.tail.speedup.600)
ls()
rm(lp.efficiency.400, lp.efficiency.200, lp.efficiency.600)
lp.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>% mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup.600
lp.speedup.200 <- lp.summary %>% filter(target_ESS==200) %>%
    mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),
           ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup.400 <- lp.summary %>% filter(target_ESS==400) %>%
    mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),
           ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>%
    mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),
           ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup <- bind_rows(lp.speedup.200, lp.speedup.400, lp.speedup.600)
lp.speedup
ggplot(lp.speedup, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_bulk_efficiency)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{bulk}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggplot(lp.speedup, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_bulk_speedup)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{bulk}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
lp.speedup
lp.speedup <- bind_rows(lp.speedup.200, lp.speedup.400, lp.speedup.600) %>% mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4),ess_tail_efficiency=ess_tail_speedup/(parallel_chains/4))
lp.speedup
ls()
rm(lp.tail.efficiency)
rm(lp.speedup.200)
rm(lp.speedup.400)
rm(lp.speedup.600)
ls()
rm(lp.bulk.efficiency)
ls()
save.image()
x <- seq(1992, 2002, by=2)
d1 <- data.frame(x=x, y=rnorm(length(x)))
xy <- expand.grid(x=x, y=x)
xy
?expand.grid
xy
d2 <- data.frame(x=xy$x, y=xy$y, z= jitter(xy$x + xy$y))
d2
d1
d1$panel <- "a"
d2$panel <- "b"
d1$z <- d1$x
d
d1
d2
d1
d <- rbind(d1, d2)
d
ggplot(data = d, mapping = aes(x = x, y = y)) + 
  facet_grid(panel~., scale="free") + 
  geom_line(data = d1, stat = "identity") + 
  geom_tile(data=d2, mapping=aes(colour=z, fill=z), stat = "identity")
lp.speedup
lp.speedup.200 <- lp.summary %>% filter(target_ESS==200) %>%
    mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),
           ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup.400 <- lp.summary %>% filter(target_ESS==400) %>%
    mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),
           ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup.600 <- lp.summary %>% filter(target_ESS==600) %>%
    mutate(ess_bulk_speedup=ess_bulk_per_total_time/(lp.summary$ess_bulk_per_total_time[1]),
           ess_tail_speedup=ess_tail_per_total_time/(lp.summary$ess_tail_per_total_time[1]))
lp.speedup <- bind_rows(lp.speedup.200, lp.speedup.400, lp.speedup.600)
lp.speedup
lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4)) %>% select(ess_bulk_speedup,ess_bulk_efficiency)
lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4)) %>%
  select(ess_bulk_speedup,ess_bulk_efficiency) %>% pivot_longer()
lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4)) %>%
  select(ess_bulk_speedup,ess_bulk_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency))
lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4)) %>%
  select(parallel_chains, target_ESS, ess_bulk_speedup,ess_bulk_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency))
lp.speedup.long  <- lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4)) %>%
  select(parallel_chains, target_ESS, ess_bulk_speedup,
  ess_bulk_efficiency, ess_tail_speedup, ess_tail_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency,ess_tail_speedup,ess_tail_efficiency))
lp.speedup.long  <- lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4), ess_tail_efficiency=ess_tail_speedup/(parallel_chains/4)) %>%
  select(parallel_chains, target_ESS, ess_bulk_speedup,
  ess_bulk_efficiency, ess_tail_speedup, ess_tail_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency,ess_tail_speedup,ess_tail_efficiency))
lp.speedup.long
lp.speedup.long %>% filter(name==ess_bulk_speedup | name==ess_bulk_efficiency)
lp.speedup.long %>% filter(name==ess_bulk_speedup | ess_bulk_efficiency)
lp.speedup.long %>% filter(name=="ess_bulk_speedup" | name="ess_bulk_efficiency")
lp.speedup.long %>% filter(name=="ess_bulk_speedup" | name=="ess_bulk_efficiency")
lp.speedup.long %>% filter(name=="ess_bulk_speedup" |
  name=="ess_bulk_efficiency") %>% ggplot(aes(x=paralle_chains,
  y=value, group=target_ESS)) + geom_line(aes(linetype=target_ESS)) + facet_grid(name~., scale="free")
lp.speedup.long %>% filter(name=="ess_bulk_speedup" |
  name=="ess_bulk_efficiency") %>% ggplot(aes(x=parallel_chains,
  y=value, group=target_ESS)) + geom_line(aes(linetype=target_ESS)) + facet_grid(name~., scale="free")
lp.speedup.long %>% filter(name=="ess_bulk_speedup" |
  name=="ess_bulk_efficiency") %>% ggplot(aes(x=parallel_chains,
  y=value, group=target_ESS)) + geom_line(aes(linetype=as.factor(target_ESS))) + facet_grid(name~., scale="free")
lp.speedup.long %>% filter(name=="ess_bulk_speedup" |
  name=="ess_bulk_efficiency") %>% ggplot(aes(x=parallel_chains,
  y=value, color=as.factor(target_ESS))) +
  geom_line(aes(linetype=as.factor(target_ESS))) +
  geom_point(aes(shape=as.factor(target_ESS))) + facet_grid(name~., scale="free")
lp.speedup.long %>% filter(name=="ess_bulk_speedup" |
  name=="ess_bulk_efficiency") %>% ggplot(aes(x=parallel_chains,
  y=value, color=as.factor(target_ESS))) +
  geom_line(aes(linetype=as.factor(target_ESS))) +
  geom_point(aes(shape=as.factor(target_ESS))) + facet_grid(name~.,
  scale="free") +     scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2')
lp.speedup.long$name
lp.speedup.long$name[lp.speedup.long$name=="ess_bulk_efficiency"] = TeX("Parallel efficiency of ESS_{bulk}")
lp.speedup.long$name[lp.speedup.long$name=="ess_bulk_efficiency"]
lp.speedup.long$name[lp.speedup.long$name=="ess_bulk_efficiency"] = "fdaklfj"
levels(lp.speedup.long$name)
lp.speedup.long  <- lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4), ess_tail_efficiency=ess_tail_speedup/(parallel_chains/4)) %>%
  select(parallel_chains, target_ESS, ess_bulk_speedup,
  ess_bulk_efficiency, ess_tail_speedup, ess_tail_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency,ess_tail_speedup,ess_tail_efficiency))

lp.speedup.long$name[lp.speedup.long$name=="ess_bulk_efficiency"] = TeX("Parallel efficiency of ESS_{bulk}")
lp.speedup.long
levels(lp.speedup.long$name) <- c(ess_bulk_efficiency=TeX("$Parallel efficiency of ESS_{bulk}$"),
ess_bulk_speed=TeX("$Speedup of ESS_{bulk}$"),ess_tail_efficiency=TeX("$Parallel efficiency of ESS_{tail}$"),
+ ess_tail_speed=TeX("$Speedup of ESS_{tail}$"))
levels(lp.speedup.long$name) <- c(ess_bulk_efficiency=TeX("$Parallel efficiency of ESS_{bulk}$"),ess_bulk_speed=TeX("$Speedup of ESS_{bulk}$"))
levels(lp.speedup.long$name) <- c(ess_bulk_efficiency=TeX("$Parallel efficiency of ESS_{bulk}$"),ess_bulk_speed=TeX("$Speedup of ESS_{bulk}$"),ess_tail_efficiency=TeX("$Parallel efficiency of ESS_{tail}$"),ess_tail_speed=TeX("$Speedup of ESS_{tail}$"))
levels(lp.speedup.long$name) <- c("a","b","c","d")
levels(lp.speedup.long$name)
lp.speedup.long  <- lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4), ess_tail_efficiency=ess_tail_speedup/(parallel_chains/4)) %>%
  select(parallel_chains, target_ESS, ess_bulk_speedup,
  ess_bulk_efficiency, ess_tail_speedup, ess_tail_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency,ess_tail_speedup,ess_tail_efficiency))

lp.speedup.long$name[lp.speedup.long$name == "ess_bulk_speedup"]=bquote('Speedup of ESS_bulk')
lp.speedup.long$name
?bquote
lp.speedup.long  <- lp.speedup %>%
  mutate(ess_bulk_efficiency=ess_bulk_speedup/(parallel_chains/4), ess_tail_efficiency=ess_tail_speedup/(parallel_chains/4)) %>%
  select(parallel_chains, target_ESS, ess_bulk_speedup,
  ess_bulk_efficiency, ess_tail_speedup, ess_tail_efficiency) %>% pivot_longer(c(ess_bulk_speedup,ess_bulk_efficiency,ess_tail_speedup,ess_tail_efficiency))
lp.speedup.long %>% filter(name=="ess_bulk_speedup" |
                           name=="ess_bulk_efficiency") %>% ggplot(aes(x=parallel_chains,
                                                                       y=value, color=as.factor(target_ESS))) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    facet_grid(name~., scale="free", labeller = label_parsed) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2')

ggplot(lp.speedup, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_bulk_speedup)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{bulk}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggsave(filename="ess_bulk_per_total_time_speedup.pdf",width=6, height=4)

ggplot(lp.parallel.efficiency, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_tail_efficiency)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{tail}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggsave(filename="ess_tail_per_total_time_speedup.pdf",width=6, height=4)

ggplot(lp.speedup, aes(group=as.factor(target_ESS),
                                   color=as.factor(target_ESS), x=parallel_chains,
                                   y=ess_tail_speedup)) +
    geom_line(aes(linetype=as.factor(target_ESS))) +
    geom_point(aes(shape=as.factor(target_ESS))) +
    scale_x_continuous(trans='log2') + scale_y_continuous(trans='log2') +
    labs(x = TeX("n_{chain}(=n_{proc})"), y = TeX("Speedup of ESS_{tail}/(Time_{total})"),  color="Target ESS", shape="Target ESS",linetype="Target ESS")
ggsave(filename="ess_tail_per_total_time_speedup.pdf",width=6, height=4)
save.image()
q()
ls()
rm("x")
rm("y")
rm("xy")
ls()
rm("d")
rm("d1")
rm("d2")
ls()
lp.parallel.efficiency
ls()
lp.speedup
lp.parallel.efficiency
ls()
rm("lp.parallel.efficiency")
lp.speedup
library("tidyverse")
lp.speedup %>% select(target_ESS==200)
lp.speedup %>% select("target_ESS"==200)
lp.speedup %>% select(target_ESS=="200")
lp.speedup %>% filter(target_ESS=="200")
lp.speedup
lp.speedup
options(tibble.width=Inf)
lp.speedup
ls()
lp.summary
lp.summary[[ess_bulk_per_total_time]]
lp.summary$ess_bulk_per_total_time
lp.summary$ess_bulk_per_total_time[1]
lp.speedup
lp.speedup %>% filter(target_ESS=200) %>% select(ess_bulk_speedup)
lp.speedup %>% filter(target_ESS==200) %>% select(ess_bulk_speedup)
lp.speedup %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_efficiency/parallel_chains * 4)
lp.speedup %>% filter(target_ESS==200) %>% mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4)
lp.speedup %>% filter(target_ESS==200) %>%  mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4,ess_tail_efficiency=ess_tail_speedup/parallel_chains * 4) %>% select(ess_bulk_efficiency)
lp.speedup %>% filter(target_ESS==200) %>%  mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4,ess_tail_efficiency=ess_tail_speedup/parallel_chains * 4) %>% select(ess_tail_efficiency)
lp.speedup %>% filter(target_ESS==400) %>%  mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4,ess_tail_efficiency=ess_tail_speedup/parallel_chains * 4) %>% select(ess_bulk_efficiency)
lp.speedup %>% filter(target_ESS==400) %>%  mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4,ess_tail_efficiency=ess_tail_speedup/parallel_chains * 4) %>% select(ess_tail_efficiency)
lp.speedup %>% filter(target_ESS==600) %>%  mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4,ess_tail_efficiency=ess_tail_speedup/parallel_chains * 4) %>% select(ess_bulk_efficiency)
lp.speedup %>% filter(target_ESS==600) %>%  mutate(ess_bulk_efficiency=ess_bulk_speedup/parallel_chains * 4,ess_tail_efficiency=ess_tail_speedup/parallel_chains * 4) %>% select(ess_tail_efficiency)
q()
